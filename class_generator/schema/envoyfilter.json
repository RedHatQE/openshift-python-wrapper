{
  "type": "object",
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": "string"
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": "string"
    },
    "metadata": {
      "description": "Standard object's metadata. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#metadata",
      "$ref": "_definitions.json#/definitions/io.k8s.apimachinery.pkg.apis.meta.v1.ObjectMeta"
    },
    "spec": {
      "description": "Customizing Envoy configuration generated by Istio. See more details at: https://istio.io/docs/reference/config/networking/envoy-filter.html",
      "type": "object",
      "properties": {
        "configPatches": {
          "description": "One or more patches with match conditions.",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "applyTo": {
                "description": "Specifies where in the Envoy configuration, the patch should be applied.",
                "type": "string",
                "enum": [
                  "INVALID",
                  "LISTENER",
                  "FILTER_CHAIN",
                  "NETWORK_FILTER",
                  "HTTP_FILTER",
                  "ROUTE_CONFIGURATION",
                  "VIRTUAL_HOST",
                  "HTTP_ROUTE",
                  "CLUSTER",
                  "EXTENSION_CONFIG",
                  "BOOTSTRAP",
                  "LISTENER_FILTER"
                ]
              },
              "match": {
                "description": "Match on listener/route configuration/cluster.",
                "type": "object",
                "properties": {
                  "cluster": {
                    "description": "Match on envoy cluster attributes.",
                    "type": "object",
                    "properties": {
                      "name": {
                        "description": "The exact name of the cluster to match.",
                        "type": "string"
                      },
                      "portNumber": {
                        "description": "The service port for which this cluster was generated.",
                        "type": "integer"
                      },
                      "service": {
                        "description": "The fully qualified service name for this cluster.",
                        "type": "string"
                      },
                      "subset": {
                        "description": "The subset associated with the service.",
                        "type": "string"
                      }
                    }
                  },
                  "context": {
                    "description": "The specific config generation context to match on.",
                    "type": "string",
                    "enum": [
                      "ANY",
                      "SIDECAR_INBOUND",
                      "SIDECAR_OUTBOUND",
                      "GATEWAY"
                    ]
                  },
                  "listener": {
                    "description": "Match on envoy listener attributes.",
                    "type": "object",
                    "properties": {
                      "filterChain": {
                        "description": "Match a specific filter chain in a listener.",
                        "type": "object",
                        "properties": {
                          "applicationProtocols": {
                            "description": "Applies only to sidecars.",
                            "type": "string"
                          },
                          "destinationPort": {
                            "description": "The destination_port value used by a filter chain's match condition.",
                            "type": "integer"
                          },
                          "filter": {
                            "description": "The name of a specific filter to apply the patch to.",
                            "type": "object",
                            "properties": {
                              "name": {
                                "description": "The filter name to match on.",
                                "type": "string"
                              },
                              "subFilter": {
                                "description": "The next level filter within this filter to match upon.",
                                "type": "object",
                                "properties": {
                                  "name": {
                                    "description": "The filter name to match on.",
                                    "type": "string"
                                  }
                                }
                              }
                            }
                          },
                          "name": {
                            "description": "The name assigned to the filter chain.",
                            "type": "string"
                          },
                          "sni": {
                            "description": "The SNI value used by a filter chain's match condition.",
                            "type": "string"
                          },
                          "transportProtocol": {
                            "description": "Applies only to `SIDECAR_INBOUND` context.",
                            "type": "string"
                          }
                        }
                      },
                      "listenerFilter": {
                        "description": "Match a specific listener filter.",
                        "type": "string"
                      },
                      "name": {
                        "description": "Match a specific listener by its name.",
                        "type": "string"
                      },
                      "portName": {
                        "type": "string"
                      },
                      "portNumber": {
                        "description": "The service port/gateway port to which traffic is being sent/received.",
                        "type": "integer"
                      }
                    }
                  },
                  "proxy": {
                    "description": "Match on properties associated with a proxy.",
                    "type": "object",
                    "properties": {
                      "metadata": {
                        "description": "Match on the node metadata supplied by a proxy when connecting to Istio Pilot.",
                        "type": "object",
                        "additionalProperties": {
                          "type": "string"
                        }
                      },
                      "proxyVersion": {
                        "description": "A regular expression in golang regex format (RE2) that can be used to select proxies using a specific version of istio proxy.",
                        "type": "string"
                      }
                    }
                  },
                  "routeConfiguration": {
                    "description": "Match on envoy HTTP route configuration attributes.",
                    "type": "object",
                    "properties": {
                      "gateway": {
                        "description": "The Istio gateway config's namespace/name for which this route configuration was generated.",
                        "type": "string"
                      },
                      "name": {
                        "description": "Route configuration name to match on.",
                        "type": "string"
                      },
                      "portName": {
                        "description": "Applicable only for GATEWAY context.",
                        "type": "string"
                      },
                      "portNumber": {
                        "description": "The service port number or gateway server port number for which this route configuration was generated.",
                        "type": "integer"
                      },
                      "vhost": {
                        "description": "Match a specific virtual host in a route configuration and apply the patch to the virtual host.",
                        "type": "object",
                        "properties": {
                          "name": {
                            "description": "The VirtualHosts objects generated by Istio are named as host:port, where the host typically corresponds to the VirtualService's host field or the hostname of a service in the registry.",
                            "type": "string"
                          },
                          "route": {
                            "description": "Match a specific route within the virtual host.",
                            "type": "object",
                            "properties": {
                              "action": {
                                "description": "Match a route with specific action type.",
                                "type": "string",
                                "enum": [
                                  "ANY",
                                  "ROUTE",
                                  "REDIRECT",
                                  "DIRECT_RESPONSE"
                                ]
                              },
                              "name": {
                                "description": "The Route objects generated by default are named as default.",
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              },
              "patch": {
                "description": "The patch to apply along with the operation.",
                "type": "object",
                "properties": {
                  "filterClass": {
                    "description": "Determines the filter insertion order.",
                    "type": "string",
                    "enum": [
                      "UNSPECIFIED",
                      "AUTHN",
                      "AUTHZ",
                      "STATS"
                    ]
                  },
                  "operation": {
                    "description": "Determines how the patch should be applied.",
                    "type": "string",
                    "enum": [
                      "INVALID",
                      "MERGE",
                      "ADD",
                      "REMOVE",
                      "INSERT_BEFORE",
                      "INSERT_AFTER",
                      "INSERT_FIRST",
                      "REPLACE"
                    ]
                  },
                  "value": {
                    "description": "The JSON config of the object being patched.",
                    "x-kubernetes-preserve-unknown-fields": true
                  }
                }
              }
            }
          }
        },
        "priority": {
          "description": "Priority defines the order in which patch sets are applied within a context.",
          "type": "integer",
          "format": "int32"
        },
        "workloadSelector": {
          "description": "Criteria used to select the specific set of pods/VMs on which this patch configuration should be applied.",
          "type": "object",
          "properties": {
            "labels": {
              "description": "One or more labels that indicate a specific set of pods/VMs on which the configuration should be applied.",
              "type": "object",
              "additionalProperties": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "status": {
      "x-kubernetes-preserve-unknown-fields": true
    }
  },
  "x-kubernetes-group-version-kind": [
    {
      "group": "networking.istio.io",
      "kind": "EnvoyFilter",
      "version": "v1alpha3"
    }
  ],
  "$schema": "http://json-schema.org/schema#"
}